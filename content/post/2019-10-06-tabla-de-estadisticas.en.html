---
title: Tabla con resumen de estadísticas de una muestra (en HTML y Latex con KableExtra) 
author: Patricio Said
date: '2019-10-06'
slug: tabla-resumen-estadisticas
categories: ["blog"]
tags: ["dplyr","tidyr","kableExtra", "HTML", "Latex","tabla","summarise"]
#image: "img/martini.jpg"
description: ""
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<p>En cualquier trabajo de investigación que involucre una muestra o conjunto de datos es importante mostrar un cuadro resumen que contenga estadísticas descriptivas del conjunto, de esta manera se puede comunicar de forma clara la dimensión de los datos del estudio.</p>
<p>Con solo dos herramientas la construcción de tablas resúmnes resulta muy facil y sencilla. Las funciones de <code>dplyr</code> permiten calcular diferentes estadísticas según diferentes grupos. Una vez terminada la tabla el paquete <code>kableExtra</code> transforma facimente la información de la tabla a formato HTML o Latex (para visualizar en PDF).</p>
<div id="los-datos-a-usar" class="section level2">
<h2>Los datos a usar</h2>
<p>Para este ejemplo utilizo los datos <code>vuelos</code> que están dentro del paquete <code>datos</code>. <code>vuelos</code> es la traducción al español del conjunto <code>nycflights13::flights</code>. Este conjunto contiene los datos de los vuelos que despegaron de Nueva York durante el 2013.</p>
<pre class="r"><code>library(datos)
library(tidyverse)
vuelos</code></pre>
<pre><code>## # A tibble: 336,776 x 19
##     anio   mes   dia horario_salida salida_programa~ atraso_salida
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;          &lt;int&gt;            &lt;int&gt;         &lt;dbl&gt;
##  1  2013     1     1            517              515             2
##  2  2013     1     1            533              529             4
##  3  2013     1     1            542              540             2
##  4  2013     1     1            544              545            -1
##  5  2013     1     1            554              600            -6
##  6  2013     1     1            554              558            -4
##  7  2013     1     1            555              600            -5
##  8  2013     1     1            557              600            -3
##  9  2013     1     1            557              600            -3
## 10  2013     1     1            558              600            -2
## # ... with 336,766 more rows, and 13 more variables:
## #   horario_llegada &lt;int&gt;, llegada_programada &lt;int&gt;, atraso_llegada &lt;dbl&gt;,
## #   aerolinea &lt;chr&gt;, vuelo &lt;int&gt;, codigo_cola &lt;chr&gt;, origen &lt;chr&gt;,
## #   destino &lt;chr&gt;, tiempo_vuelo &lt;dbl&gt;, distancia &lt;dbl&gt;, hora &lt;dbl&gt;,
## #   minuto &lt;dbl&gt;, fecha_hora &lt;dttm&gt;</code></pre>
<p>Los datos están en formato tibble. CONTINUAR ACA</p>
<pre class="r"><code>mayores_aerolineas &lt;- vuelos %&gt;% select(mes, aerolinea) %&gt;% 
  filter(mes %in% (9:11)) %&gt;% 
  group_by( aerolinea) %&gt;% 
    summarise(n = n()) %&gt;% 
  arrange(desc(n)) %&gt;% 
  slice(1:3) %&gt;% 
  ungroup()
mayores_aerolineas$aerolinea</code></pre>
<pre><code>## [1] &quot;UA&quot; &quot;EV&quot; &quot;B6&quot;</code></pre>
<pre class="r"><code>aerolineas %&gt;% 
  filter(aerolinea %in% mayores_aerolineas$aerolinea)</code></pre>
<pre><code>## # A tibble: 3 x 2
##   aerolinea nombre                  
##   &lt;chr&gt;     &lt;chr&gt;                   
## 1 B6        JetBlue Airways         
## 2 EV        ExpressJet Airlines Inc.
## 3 UA        United Air Lines Inc.</code></pre>
<pre class="r"><code>datos &lt;- vuelos %&gt;% 
  select(mes, aerolinea, atraso_llegada, atraso_salida) %&gt;% 
  filter(atraso_salida &gt; 0 , atraso_llegada &gt; 0) %&gt;% 
  filter(mes &gt;=9, mes &lt;=11) %&gt;% 
  filter(aerolinea %in% mayores_aerolineas$aerolinea) %&gt;% 
  arrange(mes)
datos</code></pre>
<pre><code>## # A tibble: 8,688 x 4
##      mes aerolinea atraso_llegada atraso_salida
##    &lt;int&gt; &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;
##  1     9 B6                     3            10
##  2     9 B6                   139           152
##  3     9 EV                     8            11
##  4     9 B6                     9             2
##  5     9 B6                    13            18
##  6     9 B6                    46            57
##  7     9 EV                    61            80
##  8     9 EV                     4            25
##  9     9 UA                    16            50
## 10     9 EV                    30            38
## # ... with 8,678 more rows</code></pre>
<pre class="r"><code>datos &lt;- datos %&gt;%  
  mutate(conjunto = sample(c(&quot;train&quot;,&quot;test&quot;), nrow(datos), replace = T, prob = c(0.8,0.2)))

datos_train &lt;- datos %&gt;% select(mes,aerolinea, conjunto, atraso_llegada) %&gt;% 
  filter(conjunto == &quot;train&quot;) %&gt;% 
  group_by(mes, aerolinea) %&gt;% 
  summarise(n_train = n(), 
            min_llegada_train = min(atraso_llegada),
            prom_llegada_train = mean(atraso_llegada),
            max_llegada_train = max(atraso_llegada),
            sd_llegada_train = sd(atraso_llegada)
            ) %&gt;% 
  ungroup()

datos_test &lt;- datos %&gt;% select(mes,aerolinea, conjunto, atraso_llegada) %&gt;% 
  filter(conjunto == &quot;test&quot;) %&gt;% 
  group_by(mes, aerolinea) %&gt;% 
  summarise(n_test = n(), 
            min_llegada_test = min(atraso_llegada),
            prom_llegada_test = mean(atraso_llegada),
            max_llegada_test = max(atraso_llegada),
            sd_llegada_test = sd(atraso_llegada)
            ) %&gt;% 
  ungroup()

library(kableExtra) 
resumen &lt;- left_join(datos_train,datos_test) %&gt;% 
  mutate(mes = case_when(
                      mes == 9 ~ &quot;Septiembre&quot;,
                      mes ==10 ~ &quot;Octubre&quot;,
                      mes ==11 ~ &quot;Noviembre&quot;)) %&gt;% 
  left_join(aerolineas) %&gt;% 
  select(mes, nombre, everything(), - (aerolinea))</code></pre>
<pre class="r"><code>head1 &lt;- paste0(&quot;Conjunto entrenamiento (N=&quot;, sum(datos_train$n_train),&quot;)&quot;,collapse = &quot;&quot;)
head2 &lt;- paste0(&quot;Conjunto prueba (N=&quot; , sum(datos_test$n_test), &quot;)&quot;)

resumen %&gt;% select(-mes) %&gt;% 
kable( format.args = list(decimal.mark = &#39;,&#39;, big.mark = &quot;.&quot;),
         col.names = ( c(&quot;Aerolínea&quot;,rep(c(&quot;N&quot;,&quot;Min.&lt;br&gt;*(minutos)*&quot;,&quot;Media&lt;br&gt;*(minutos)*&quot;,&quot;Max.&lt;br&gt;*(minutos)*&quot;,&quot;D.E&lt;br&gt;*(minutos)*&quot;),2))), 
         digits = 1 , escape = F) %&gt;% 
 kable_styling(c(&quot;striped&quot;),font_size = 11) %&gt;% 
 add_header_above(header = c(&quot; &quot;=1, &quot;Conjunto entrenamiento (N=6.973)&quot; = 5, &quot;Conjunto prueba (N=1.715)&quot; = 5 ) ) %&gt;% 
  pack_rows(&quot;Septiembre&quot;, 1, 3) %&gt;% 
  pack_rows(&quot;Octubre&quot;, 4, 6) %&gt;% 
  pack_rows(&quot;Noviembre&quot;, 7,9)</code></pre>
<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Conjunto entrenamiento (N=6.973)
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Conjunto prueba (N=1.715)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Aerolínea
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Min.<br><em>(minutos)</em>
</th>
<th style="text-align:right;">
Media<br><em>(minutos)</em>
</th>
<th style="text-align:right;">
Max.<br><em>(minutos)</em>
</th>
<th style="text-align:right;">
D.E<br><em>(minutos)</em>
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Min.<br><em>(minutos)</em>
</th>
<th style="text-align:right;">
Media<br><em>(minutos)</em>
</th>
<th style="text-align:right;">
Max.<br><em>(minutos)</em>
</th>
<th style="text-align:right;">
D.E<br><em>(minutos)</em>
</th>
</tr>
</thead>
<tbody>
<tr grouplength="3">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>Septiembre</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
JetBlue Airways
</td>
<td style="text-align:right;">
609
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
50,9
</td>
<td style="text-align:right;">
396
</td>
<td style="text-align:right;">
59,6
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
54,4
</td>
<td style="text-align:right;">
317
</td>
<td style="text-align:right;">
66,6
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
ExpressJet Airlines Inc. 
</td>
<td style="text-align:right;">
751
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
50,6
</td>
<td style="text-align:right;">
444
</td>
<td style="text-align:right;">
59,4
</td>
<td style="text-align:right;">
172
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
52,2
</td>
<td style="text-align:right;">
352
</td>
<td style="text-align:right;">
57,8
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
United Air Lines Inc. 
</td>
<td style="text-align:right;">
578
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
49,6
</td>
<td style="text-align:right;">
406
</td>
<td style="text-align:right;">
70,0
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
61,3
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:right;">
72,5
</td>
</tr>
<tr grouplength="3">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>Octubre</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
JetBlue Airways
</td>
<td style="text-align:right;">
553
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
36,2
</td>
<td style="text-align:right;">
366
</td>
<td style="text-align:right;">
43,0
</td>
<td style="text-align:right;">
144
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
41,6
</td>
<td style="text-align:right;">
248
</td>
<td style="text-align:right;">
51,2
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
ExpressJet Airlines Inc. 
</td>
<td style="text-align:right;">
1.156
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
51,9
</td>
<td style="text-align:right;">
318
</td>
<td style="text-align:right;">
50,6
</td>
<td style="text-align:right;">
304
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
50,0
</td>
<td style="text-align:right;">
291
</td>
<td style="text-align:right;">
47,9
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
United Air Lines Inc. 
</td>
<td style="text-align:right;">
869
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35,4
</td>
<td style="text-align:right;">
288
</td>
<td style="text-align:right;">
42,2
</td>
<td style="text-align:right;">
204
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
34,3
</td>
<td style="text-align:right;">
252
</td>
<td style="text-align:right;">
44,9
</td>
</tr>
<tr grouplength="3">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>Noviembre</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
JetBlue Airways
</td>
<td style="text-align:right;">
647
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
36,7
</td>
<td style="text-align:right;">
299
</td>
<td style="text-align:right;">
38,5
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
37,3
</td>
<td style="text-align:right;">
217
</td>
<td style="text-align:right;">
39,2
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
ExpressJet Airlines Inc. 
</td>
<td style="text-align:right;">
990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
42,4
</td>
<td style="text-align:right;">
389
</td>
<td style="text-align:right;">
43,0
</td>
<td style="text-align:right;">
249
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
43,7
</td>
<td style="text-align:right;">
250
</td>
<td style="text-align:right;">
42,9
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
United Air Lines Inc. 
</td>
<td style="text-align:right;">
832
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35,0
</td>
<td style="text-align:right;">
346
</td>
<td style="text-align:right;">
47,4
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
37,3
</td>
<td style="text-align:right;">
291
</td>
<td style="text-align:right;">
47,2
</td>
</tr>
</tbody>
</table>
</div>
